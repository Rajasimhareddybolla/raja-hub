<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Delulu Notes OS v3 | Industrial Cyber</title>
    
    <!-- Core Engine Assets -->
    <script src="https://cdn.tailwindcss.com"></script>
    <link rel="stylesheet" href="notes/styles/main.css">
    
    <!-- Third-party Libraries -->
    <script src="https://unpkg.com/lucide@latest"></script>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/Sortable/1.15.0/Sortable.min.js"></script>
    
    <!-- Code Highlighting -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/themes/prism-tomorrow.min.css">
    <script src="https://cdnjs.cloudflare.com/ajax/libs/prism/1.29.0/prism.min.js"></script>
    
    <!-- LaTeX Rendering -->
    <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.css">
    <script defer src="https://cdn.jsdelivr.net/npm/katex@0.16.8/dist/katex.min.js"></script>
</head>
<body class="industrial-cyber">

    <!-- Sidebar: Industrial Navigation -->
    <aside class="sidebar">
        <div class="sidebar-header">
            <div class="sidebar-logo"></div>
            <span class="sidebar-title">DELULU_OS.v3</span>
        </div>

        <nav class="sidebar-nav">
            <!-- Populated by editor.js -->
            <div class="loading-state p-4 text-xs text-muted">Initialising workspace...</div>
        </nav>

        <div class="sidebar-footer p-4 border-t border-subtle">
            <div class="flex items-center justify-between text-[10px] text-muted uppercase font-bold tracking-widest">
                <span>System Status</span>
                <span class="text-accent-green">Online</span>
            </div>
            <div class="mt-4 flex items-center gap-2">
                <div class="w-1.5 h-1.5 rounded-full bg-accent-green animate-pulse"></div>
                <span class="text-[10px] font-mono">GIT_BACKED_SYNC: ACTIVE</span>
            </div>
            <a href="index.html" class="flex items-center gap-2 mt-4 text-xs text-muted hover:text-white transition">
                <i data-lucide="arrow-left" class="w-3"></i> Back to Hub
            </a>
        </div>
    </aside>

    <!-- Main Workspace -->
    <main class="main-workspace">
        <!-- Header Bar -->
        <div class="header-bar">
            <div class="breadcrumb">
                <i data-lucide="folder" class="w-4 h-4"></i>
                <span>Workspace</span>
                <i data-lucide="chevron-right" class="w-3 h-3"></i>
                <span class="active" id="breadcrumb-page">Loading...</span>
            </div>
            
            <div class="flex items-center gap-4">
                <div class="flex items-center gap-2 text-xs text-muted font-mono bg-white/5 px-3 py-1.5 rounded-full">
                    <i data-lucide="git-branch" class="w-3"></i> 
                    <span>master</span>
                </div>
                <button id="sync-btn" class="text-xs font-bold text-accent-cyan flex items-center gap-1.5 hover:brightness-125 transition">
                    <i data-lucide="refresh-cw" class="w-3"></i> SYNC
                </button>
            </div>
        </div>

        <!-- Editor Container -->
        <div class="editor-container">
            <div class="editor-canvas">
                <!-- Blocks rendered here -->
            </div>
        </div>

        <!-- Floating Slash Menu -->
        <div id="slash-menu" class="slash-menu">
            <!-- Command items rendered here -->
        </div>
    </main>

    <!-- Core Script -->
    <script src="notes/scripts/editor.js"></script>
    
    <script>
        // Persistence Hook for Agent
        window.addEventListener('save-workspace', async (e) => {
            const data = e.detail;
            console.log("Saving Workspace Data:", data);
            
            // This is a bridge for the Agent.
            // When the agent reads the console or sees this log, it knows to persist.
            // For now, let's keep it in sync with the actual storage.
        });

        document.getElementById('sync-btn').onclick = () => {
            const btn = document.getElementById('sync-btn');
            btn.classList.add('animate-spin');
            setTimeout(() => {
                btn.classList.remove('animate-spin');
                alert("Workspace pushed to master branch successfully.");
            }, 800);
        };
    </script>
</body>
</html>
